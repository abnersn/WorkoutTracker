(this["webpackJsonpworkout-tracker"]=this["webpackJsonpworkout-tracker"]||[]).push([[0],{46:function(e,t,r){},53:function(e,t,r){},55:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"en",(function(){return p})),r.d(n,"pt",(function(){return m}));var a=r(1),i=r.n(a),s=r(35),c=r.n(s),o=(r(46),r(17)),u=r(7),l=r(4),d=r(56),f=r(22),b=r(16),p={no_exercise:"No exercises to list.",start:"Start",close:"Close",complete:"Complete",reset:"Reset",sets:"Sets",reps:"Reps",history:"History",view:"View",last_run:"Last run",time:"Time",rest:"Rest",weight:"Weight",confirm_delete:"Are you sure you want to delete this workout?",save_progress:"Would you like to save your progress?",erase_workout:"Are you sure you want to erase the current workout?",back:"Back",reset_workout:"Reset workout",finish_workout:"Finish Workout",finish_exercise:"Finish exercise",start_workout:"Start workout",add_exercise:"Add exercise",exercise_name:"Exercise name",no_sets:"No sets for this exercise.",remove_set:"Remove set",add_set:"Add set",rpe_title_1:"Very light activity",rpe_title_2:"Light activity",rpe_title_3:"Light activity",rpe_title_4:"Moderate activity",rpe_title_5:"Moderate activity",rpe_title_6:"Moderate activity",rpe_title_7:"Vigorous activity",rpe_title_8:"Vigorous activity",rpe_title_9:"Very hard activity",rpe_title_10:"Max effort activity",rpe_desc_1:"Hardly any exertion, but more than sleeping, watching TV, etc.",rpe_desc_2:"Could mantain for hours. Easy to breathe and carry a conversation.",rpe_desc_3:"Could mantain for hours. Easy to breathe and carry a conversation.",rpe_desc_4:"Breathing heavily, can mantain a conversation, but more challenging.",rpe_desc_5:"Breathing heavily, can mantain a conversation, but more challenging.",rpe_desc_6:"Breathing heavily, can mantain a conversation, but more challenging.",rpe_desc_7:"Almost uncofortable, short of breath, can speak a sentence.",rpe_desc_8:"Almost uncofortable, short of breath, can speak a sentence.",rpe_desc_9:"Very difficult to mantain, can barely breathe, can speak a few words",rpe_desc_10:"Almost impossible to keep going. Out of breath, unable to talk.",rpe:"Rate of perceived exertion ",workouts_list:"Workouts list",workout_name:"Workout name",add_workout:"Add workout",remove_workout:"Remove workout",no_workout:"No workout",load_error:"Could not load data",times_up:"Rest time's up!",persist_error:"Could not save data"},m={no_exercise:"Nenhum exerc\xedcio para listar.",start:"Iniciar",close:"Fechar",complete:"Completar",reset:"Reiniciar",sets:"S\xe9ries",reps:"Repet.",time:"Tempo",history:"Hist\xf3rico",view:"Ver",last_run:"\xdaltima vez",rest:"Descanso",weight:"Peso",confirm_delete:"Tem certeza que deseja remover este treino?",save_progress:"Voc\xea gostaria de salvar seu progresso?",erase_workout:"Tem certeza que deseja apagar o treino atual?",back:"Voltar",reset_workout:"Apagar treino",finish_workout:"Concluir treino",finish_exercise:"Concluir exerc\xedcio",start_workout:"Iniciar treino",add_exercise:"Adicionar exerc\xedcio",exercise_name:"Nome do exerc\xedcio",no_sets:"Nenhuma s\xe9rie para este exerc\xedcio.",remove_set:"Remover s\xe9rie",add_set:"Adicionar s\xe9rie",rpe_title_1:"Atividade muito leve",rpe_title_2:"Atividade leve",rpe_title_3:"Atividade leve",rpe_title_4:"Atividade moderada",rpe_title_5:"Atividade moderada",rpe_title_6:"Atividade moderada",rpe_title_7:"Atividade vigorosa",rpe_title_8:"Atividade vigorosa",rpe_title_9:"Atividade muito dif\xedcil",rpe_title_10:"Esfor\xe7o m\xe1ximo",rpe_desc_1:"Quase nenhum esfor\xe7o, por\xe9m mais que assistir TV ou dormir.",rpe_desc_2:"Conseguiria manter por horas. Respira facilmente e consegue conversar normalmente.",rpe_desc_3:"Conseguiria manter por horas. Respira facilmente e consegue conversar normalmente.",rpe_desc_4:"Respira com dificuldade, conseguiria manter uma conversa, mas seria mais dif\xedcil.",rpe_desc_5:"Respira com dificuldade, conseguiria manter uma conversa, mas seria mais dif\xedcil.",rpe_desc_6:"Respira com dificuldade, conseguiria manter uma conversa, mas seria mais dif\xedcil.",rpe_desc_7:"Quase desconfort\xe1vel, falta f\xf4lego, consegue dizer uma frase no m\xe1ximo.",rpe_desc_8:"Quase desconfort\xe1vel, falta f\xf4lego, consegue dizer uma frase no m\xe1ximo.",rpe_desc_9:"Muito dif\xedcil de manter, mal consegue respirar, consegue dizer apenas algumas palavras.",rpe_desc_10:"Imposs\xedvel continuar, totalmente sem f\xf4lego, n\xe3o consegue falar.",rpe:"Escala de esfor\xe7o ",workouts_list:"Lista de treinos",workout_name:"Nome do treino",add_workout:"Adicionar treino",remove_workout:"Remover treino",no_workout:"Nenhum treino dispon\xedvel",times_up:"Tempo de descanso acabou!",load_error:"N\xe3o foi poss\xedvel carregar os dados",persist_error:"N\xe3o foi poss\xedvel salvar as altera\xe7\xf5es"};function x(){var e=Object(a.useState)("en"),t=Object(l.a)(e,2),r=t[0],i=t[1];Object(a.useEffect)((function(){var e=window.navigator.language.split("-")[0];["en","pt"].includes(e)?i(e):i("en")}),[]);var s=p;return{t:function(e){return n[r][e]||s[e]||e},language:r}}var j=r(6);function v(e){return e.sets.some((function(e){return"COMPLETE"!==e.stage}))}function h(e){if(e<0)return"-".concat(h(Math.abs(e)));var t=function(e){return"".concat(e%60).padStart(2,"0")},r=Math.floor(e/60);if(0===r)return"".concat(e);if(r>=60){var n=Math.floor(r/60);return"".concat(n,":").concat(t(r),":").concat(t(e))}return"".concat(r,":").concat(t(e))}var g=r(11),O=r(27),_=r(0);function y(e){var t=e.children;return Object(_.jsx)("div",{className:"container bg-white max-w-5xl min-h-screen m-auto border shadow-md place-self-center pb-24",children:t})}function k(e){var t=e.children;return Object(_.jsx)("div",{className:"fixed flex justify-center bottom-0 w-screen left-0",children:Object(_.jsx)("div",{className:"flex justify-end items-center border-t border-indigo-200 bg-white w-full max-w-5xl p-3 pb-8",children:t})})}function E(e){var t=e.Icon,r=e.type,n=void 0===r?"neutral":r,a=e.label,i=Object(O.a)(e,["Icon","type","label"]),s={primary:"bg-blue-500 ml-2 border-blue-600 focus:ring-blue-200 active:bg-blue-700",neutral:"bg-indigo-500 ml-2 border-indigo-600 focus:ring-indigo-200 active:bg-indigo-700",success:"bg-green-500 ml-2 border-green-600 focus:ring-green-200 active:bg-green-700"},c=s[n]||s.neutral;return Object(_.jsxs)("button",Object(g.a)(Object(g.a)({},i),{},{className:"border flex uppercase focus:ring-2 text-sm items-center text-white px-3 py-2 rounded-md ".concat(c),children:[t&&Object(_.jsx)(t,{className:"mr-1 text-lg"})," ",a]}))}function w(e){var t=e.type,r=void 0===t?"neutral":t,n=e.children,a={primary:"border-blue-500 text-blue-700",neutral:"border-indigo-500 text-indigo-700",success:"border-green-500 text-green-700"},i=a[r]||a.neutral;return Object(_.jsx)("div",{className:"text-xl mr-auto border-l-2 pl-2 bg-white ".concat(i),children:n})}function N(e){var t=e.small,r=void 0!==t&&t,n=e.className,a=e.children,i=r?"text-xs":"text-sm";return Object(_.jsx)("p",{className:"".concat(i," uppercase tracking-wider ").concat(n),children:a})}function I(e){var t=e.onSubmit,r=e.value,n=e.onChange,a=e.placeholder,i=e.label;return Object(_.jsxs)("form",{onSubmit:t,className:"m-3 pt-3 border-t border-indigo-200",children:[Object(_.jsx)("div",{className:"flex p-2 items-center bg-indigo-50 rounded-xl border border-indigo-200",children:Object(_.jsx)("input",{required:!0,value:r,onChange:n,className:"text-indigo-800 px-2 w-2 flex-1 py-1 rounded border border-indigo-200 placeholder-indigo-400 focus:ring-2 focus:ring-indigo-200",type:"text",placeholder:a})}),Object(_.jsx)("div",{className:"flex justify-end mt-1",children:Object(_.jsxs)("button",{className:"text-indigo-500 text-sm px-1",children:[" ",i]})})]})}function S(e){var t=e.isActive,r=void 0!==t&&t,n=e.type,a=void 0===n?"neutral":n,i=e.children,s={primary:"border-blue-200 bg-blue-50 ".concat(r?"ring-2 ring-blue-200":""),neutral:"border-indigo-200 bg-indigo-50 ".concat(r?"ring-2 ring-indigo-200":""),success:"border-green-200 bg-green-50 ".concat(r?"ring-2 ring-green-200":"")},c=s[a]||s.neutral;return Object(_.jsx)("div",{className:"p-2 border ".concat(c," rounded-xl"),children:i})}function T(e){var t=e.children;return Object(_.jsx)("ul",{className:"flex flex-col space-y-3",children:t})}function C(e){var t=e.isActive,r=e.children,n=e.className,a=Object(O.a)(e,["isActive","children","className"]),i=t?"ring-2 ring-indigo-200 border-indigo-400":"";return Object(_.jsx)("div",Object(g.a)(Object(g.a)({},a),{},{className:"bg-white p-2 rounded-md shadow border border-indigo-200 ".concat(i," ").concat(n),children:r}))}function A(e){var t=e.children,r=e.className;return Object(_.jsx)("h3",{className:"text-lg font-semibold text-indigo-800 ".concat(r),children:t})}function R(e){var t=e.children;return Object(_.jsx)("p",{className:"text-indigo-500 text-sm pb-1",children:t})}function D(e){var t=e.children,r=Object(O.a)(e,["children"]);return Object(_.jsx)("button",Object(g.a)(Object(g.a)({},r),{},{className:"text-indigo-500 text-sm px-1",children:t}))}function L(e){var t=e.children;return Object(_.jsx)("div",{className:"flex justify-end mt-1 space-x-4",children:t})}var P=r(19),W=r(5),M=r.n(W),V=r(9),q=r(36),F=r(37),U=r(41),B=function(){function e(){Object(q.a)(this,e),this.db=null}return Object(F.a)(e,[{key:"init",value:function(){var e=Object(V.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("indexedDB"in window){e.next=3;break}return alert("This app needs indexedDb support to run."),e.abrupt("return");case 3:return e.next=5,Object(U.a)("workoutTracker",1,{upgrade:function(e){e.objectStoreNames.contains("workouts")||e.createObjectStore("workouts",{keyPath:"id"}),e.objectStoreNames.contains("logs")||e.createObjectStore("logs",{autoIncrement:!0})}});case 5:this.db=e.sent;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAllData",value:function(){var e=Object(V.a)(M.a.mark((function e(t){var r,n,a,i,s;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],n=this.db.transaction(t,"readonly"),a=n.objectStore(t),e.next=5,a.openCursor();case 5:i=e.sent;case 6:if(!i){e.next=15;break}return(s=i.value).persistenceKey=i.key,r.push(s),e.next=12,i.continue();case 12:i=e.sent,e.next=6;break;case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getData",value:function(e,t){return this.db.transaction(e,"readonly").objectStore(e).get(t)}},{key:"runInWorkouts",value:function(e){var t=this.db.transaction("workouts","readwrite");return e(t.objectStore("workouts")),t.complete}},{key:"runInLogs",value:function(e){var t=this.db.transaction("logs","readwrite");return e(t.objectStore("logs")),t.complete}},{key:"saveLogEntry",value:function(e){return this.runInLogs((function(t){return t.add(e)}))}},{key:"eraseLogEntry",value:function(e){return this.runInLogs((function(t){return t.delete(e)}))}},{key:"saveWorkout",value:function(e){return this.runInWorkouts((function(t){return t.add(e)}))}},{key:"eraseWorkout",value:function(e){return this.runInWorkouts((function(t){return t.delete(e)}))}},{key:"getLastLogEntry",value:function(){var e=Object(V.a)(M.a.mark((function e(t){var r,n;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAllData("logs");case 2:return r=e.sent,n=r.filter((function(e){return e.id===t})).sort((function(e,t){return t.date-e.date})),e.abrupt("return",n[0]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadNewWorkout",value:function(){var e=Object(V.a)(M.a.mark((function e(t){var r,n,a,i,s,c,o;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLastLogEntry(t);case 2:if(r=e.sent,e.t0=r,e.t0){e.next=8;break}return e.next=7,this.getData("workouts",t);case 7:e.t0=e.sent;case 8:(n=e.t0).date=new Date,n.isComplete=!1,n.duration=0,a=Object(P.a)(n.exercises);try{for(a.s();!(i=a.n()).done;){s=i.value,c=Object(P.a)(s.sets);try{for(c.s();!(o=c.n()).done;)o.value.stage="IDLE"}catch(u){c.e(u)}finally{c.f()}}}catch(u){a.e(u)}finally{a.f()}return e.abrupt("return",n);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadWorkoutFromLogs",value:function(){var e=Object(V.a)(M.a.mark((function e(t){var r,n,a,i,s,c;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("logs",t);case 2:(r=e.sent).date=new Date(r.date),n=Object(P.a)(r.exercises);try{for(n.s();!(a=n.n()).done;){i=a.value,s=Object(P.a)(i.sets);try{for(s.s();!(c=s.n()).done;)c.value.stage="COMPLETE"}catch(o){s.e(o)}finally{s.f()}}}catch(o){n.e(o)}finally{n.f()}return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadWorkoutLogById",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?this.loadNewWorkout(e):this.loadWorkoutFromLogs(e)}}]),e}();function G(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),r=t[0],n=t[1];return Object(a.useEffect)((function(){var e=new B;e.init().then((function(){return n(e)}))}),[]),r}function K(e){var t={id:e,isComplete:!0,activeSetId:null,activeExerciseId:null};t.date=new Date,t.name=document.querySelector(".workout-name").textContent.trim(),t.duration=Number(document.querySelector(".workout-duration").dataset.value),t.exercises=[];var r,n=document.querySelectorAll(".exercise"),a=Object(P.a)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value,s={};s.name=i.querySelector(".exercise-name").textContent.trim(),s.id=i.dataset.id,s.sets=[];var c,o=i.querySelectorAll(".set-display"),u=Object(P.a)(o);try{for(u.s();!(c=u.n()).done;){var l=c.value,d={};d.id=l.dataset.id,d.defaultDurationTime=Number(l.querySelector(".time .value").dataset.value),d.defaultReps=Number(l.querySelector(".reps .value").dataset.value),d.defaultWeight=Number(l.querySelector(".weight .value").dataset.value),d.defaultRestTime=Number(l.querySelector(".rest .value").dataset.value),d.stage="COMPLETE",s.sets.push(d)}}catch(f){u.e(f)}finally{u.f()}s.rpe=Number(i.querySelector(".rpe").value),t.exercises.push(s)}}catch(f){a.e(f)}finally{a.f()}return t}var z={pt:f.a,en:b.a};function X(e){var t=e.stage,r=e.onClick,n=void 0===r?function(){}:r,a=x().t,i={IDLE:a("start"),ACTIVE:a("rest"),RESTING:a("complete"),COMPLETE:a("reset")},s={IDLE:j.i,ACTIVE:j.h,RESTING:j.c,COMPLETE:j.j},c=i[t],o=s[t],u={IDLE:"neutral",ACTIVE:"neutral",RESTING:"neutral",COMPLETE:"primary"}[t];return Object(_.jsx)(E,{onClick:n,type:u,label:c,Icon:o})}function H(e){var t,r=e.state,n=e.dispatch,i=e.isReadOnly,s=x(),c=s.t,o=s.language,f=G(),b=Object(u.f)(),p=Object(a.useState)(r.duration||0),m=Object(l.a)(p,2),g=m[0],O=m[1],y=Object(a.useState)(!1),I=Object(l.a)(y,2),S=I[0],T=I[1],C=Object(a.useState)(!1),A=Object(l.a)(C,2),R=A[0],D=A[1];Object(a.useEffect)((function(){if(R){var e=setInterval((function(){O((function(e){return e+1}))}),1e3);return function(){return clearInterval(e)}}}),[R]);var L=function(){b.push("/")},P=[null,null],W=r.exercises.find((function(e){return e.id===r.activeExerciseId})),M=W?W.sets.find((function(e){return e.id===r.activeSetId})):null,V=Boolean(M),q=r.exercises.length>0,F=(null===(t=r.exercises[0])||void 0===t?void 0:t.sets.length)>0;i||S?P[0]=Object(_.jsx)(E,{type:"primary",label:c("back"),onClick:L,Icon:j.a}):R?(V&&(P[0]=Object(_.jsx)(X,{onClick:function(){n({type:"UPDATE_SET_STAGE"})},stage:M.stage})),r.exercises.some(v)?v(W)||(P[1]=Object(_.jsx)(E,{type:"success",label:c("finish_exercise"),Icon:j.k,onClick:function(){n({type:"COMPLETE_EXERCISE"})}})):P[1]=Object(_.jsx)(E,{type:"success",label:c("finish_workout"),Icon:j.n,onClick:function(){if(window.confirm(c("save_progress"))){var e=K(r.id);null===f||void 0===f||f.saveLogEntry(e),T(!0),D(!1),n({type:"COMPLETE_WORKOUT"})}}})):q&&F&&!S&&(P[0]=Object(_.jsx)(E,{type:"primary",label:c("start_workout"),onClick:function(){var e,t,a;D(!0),n({type:"UPDATE_ACTIVE_SET",payload:{exerciseId:null===(e=r.exercises[0])||void 0===e?void 0:e.id,setId:null===(t=r.exercises[0])||void 0===t||null===(a=t.sets[0])||void 0===a?void 0:a.id}}),n({type:"UPDATE_SET_STAGE"})},Icon:j.i}));var U=R||!S?"neutral":"success",B=z[o],H={};B&&(H.locale=B);var Q=r.date||new Date;return Object(_.jsxs)(k,{children:[Object(_.jsxs)(w,{type:U,children:[Object(_.jsx)(j.l,{className:"inline -mt-1 mr-1 -ml-1"}),Object(_.jsx)("time",{className:"workout-duration","data-value":g,children:h(g)}),Object(_.jsx)(N,{small:!0,children:Object(d.a)(Q,"PP",H)})]}),P[0]," ",P[1]]})}function Q(e){var t=x().t,r=Object(a.useState)(""),n=Object(l.a)(r,2),i=n[0],s=n[1],c=e.dispatch;return Object(_.jsx)(I,{onSubmit:function(e){e.preventDefault(),s(""),c({type:"ADD_EXERCISE",payload:{name:i}})},onChange:function(e){return s(e.target.value)},placeholder:t("exercise_name"),label:t("add_exercise"),value:i})}function J(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),r=t[0],n=t[1],i=Object(a.useState)(!1),s=Object(l.a)(i,2),c=s[0],o=s[1];if(!("Notification"in window))return{hasAskedPermission:!0,notify:function(){},hasNotificationPermission:c,requestNotificationPermission:function(){}};function u(){return(u=Object(V.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Notification.requestPermission();case 2:t=e.sent,o("granted"===t),n(!0);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){o("granted"===Notification.permission),n("default"!==Notification.permission)}),[]),{hasAskedPermission:r,notify:function(e){new Notification("Workout tracker",{body:e,vibrate:!0})},hasNotificationPermission:c,requestNotificationPermission:function(){return u.apply(this,arguments)}}}function Y(e){var t=e.inputProps,r=e.labelText,n=e.value,a=void 0===n?null:n,i=e.formatFunction,s=void 0===i?function(e){return e}:i,c=e.type,o=void 0===c?"neutral":c,u=e.isEdit,l=void 0!==u&&u,d=e.onToggleEdit,f=void 0===d?function(){}:d,b=e.onChange,p=void 0===b?function(){}:b,m={primary:"text-blue-800 bg-blue-50 border-blue-200 focus:ring-blue-100",neutral:"text-indigo-800 bg-indigo-50 border-indigo-200 focus:ring-indigo-100",success:"text-green-800 bg-green-50 border-green-200 focus:ring-green-100",danger:"text-red-800 bg-red-50 border-red-200 focus:ring-red-100",highlight:"text-cyan-800 bg-cyan-50 border-cyan-200 focus:ring-cyan-100"};return Object(_.jsxs)("label",{className:{primary:"text-blue-800",neutral:"text-indigo-800",success:"text-green-800",danger:"text-red-800",highlight:"text-cyan-800"}[o],children:[Object(_.jsx)(N,{className:"mb-1",children:r}),l?Object(_.jsx)("input",Object(g.a)(Object(g.a)({},t),{},{className:"block tabuler-nums w-full px-1 rounded shadow-sm border focus:ring-2 ".concat(m[o]),value:a,autoFocus:!0,onFocus:function(e){return e.target.select()},onBlur:function(){return l&&f(!1)},onChange:function(e){return p(Number(e.target.value))}})):Object(_.jsx)("span",{"data-value":a,tabIndex:0,onFocus:function(){return l||f(!0)},className:"value block tabuler-nums w-full px-1 rounded shadow-sm border ".concat(m[o]),children:s(Number(a))})]})}function Z(e){var t=e.id,r=e.exerciseId,n=e.defaultDurationTime,i=void 0===n?0:n,s=e.defaultRestTime,c=void 0===s?30:s,o=e.defaultReps,u=void 0===o?8:o,d=e.defaultWeight,f=void 0===d?10:d,b=e.isReadOnly,p=void 0!==b&&b,m=e.onClick,j=void 0===m?function(){}:m,v=e.dispatch,g=void 0===v?function(){}:v,O=e.isActive,y=void 0===O||O,k=e.stage,E=void 0===k?"IDLE":k,w=Object(a.useState)(i),N=Object(l.a)(w,2),I=N[0],S=N[1],T=Object(a.useState)(c),A=Object(l.a)(T,2),R=A[0],D=A[1],L=Object(a.useState)(u),P=Object(l.a)(L,2),W=P[0],M=P[1],V=Object(a.useState)(f),q=Object(l.a)(V,2),F=q[0],U=q[1],B=Object(a.useState)(!1),G=Object(l.a)(B,2),K=G[0],z=G[1],X=Object(a.useState)(!1),H=Object(l.a)(X,2),Q=H[0],Z=H[1],$=Object(a.useState)(!1),ee=Object(l.a)($,2),te=ee[0],re=ee[1],ne=Object(a.useState)(!1),ae=Object(l.a)(ne,2),ie=ae[0],se=ae[1],ce=J().notify,oe=Object(a.useRef)(),ue=x().t;Object(a.useEffect)((function(){(K||Q||te||ie)&&g({type:"UPDATE_ACTIVE_SET",payload:{setId:t,exerciseId:r}})}),[g,K,Q,ie,te,t,r]),Object(a.useEffect)((function(){"IDLE"===E&&"COMPLETE"===oe.current&&(S(0),D(c),M(u),U(f))}),[c,u,f,E]),Object(a.useEffect)((function(){oe.current=E}),[E]),Object(a.useEffect)((function(){if("ACTIVE"===E&&!K){var e=setInterval((function(){S((function(e){return Number(e)+1}))}),1e3);return function(){return clearInterval(e)}}}),[E,K]),Object(a.useEffect)((function(){if("RESTING"===E&&!ie){var e=setInterval((function(){D((function(e){return Number(e)-1}))}),1e3);return function(){return clearInterval(e)}}}),[E,c,ie]),Object(a.useEffect)((function(){0===R&&ce(ue("times_up"))}),[R]);var le={type:"number",pattern:"\\d+",min:"0",inputMode:"numeric"},de="COMPLETE"===E?"success":"neutral";return Object(_.jsxs)(C,{onClick:j,"data-id":t,className:"set-display flex space-x-2",isActive:y&&!p,children:[Object(_.jsx)("div",{className:"time flex-1",children:Object(_.jsx)(Y,{inputProps:le,isEdit:K&&!p,onToggleEdit:z,onChange:S,value:I,formatFunction:h,type:"ACTIVE"===E?"highlight":de,labelText:ue("time"),defaultValue:"0"})}),Object(_.jsx)("div",{className:"reps flex-1",children:Object(_.jsx)(Y,{inputProps:le,isEdit:Q&&!p,onToggleEdit:Z,onChange:M,value:W,type:de,labelText:ue("reps"),defaultValue:"8"})}),Object(_.jsx)("div",{className:"weight flex-1",children:Object(_.jsx)(Y,{inputProps:le,isEdit:te&&!p,onToggleEdit:re,onChange:U,value:F,type:de,labelText:ue("weight"),defaultValue:"10"})}),Object(_.jsx)("div",{className:"rest flex-1",children:Object(_.jsx)(Y,{inputProps:le,isEdit:ie&&!p,onToggleEdit:se,onChange:D,value:R>0?R:-R,type:"RESTING"===E?R<0?"danger":"highlight":de,formatFunction:h,labelText:ue("rest"),defaultValue:c})})]})}function $(e){var t=e.defaultRPE,r=void 0===t?5:t,n=e.isReadOnly,i=x().t,s=Object(a.useState)(r),c=Object(l.a)(s,2),o=c[0],u=c[1],d=Object(a.useState)(!1),f=Object(l.a)(d,2),b=f[0],p=f[1],m=[i("rpe_title_1"),i("rpe_title_2"),i("rpe_title_3"),i("rpe_title_4"),i("rpe_title_5"),i("rpe_title_6"),i("rpe_title_7"),i("rpe_title_8"),i("rpe_title_9"),i("rpe_title_10")],v=[i("rpe_desc_1"),i("rpe_desc_2"),i("rpe_desc_3"),i("rpe_desc_4"),i("rpe_desc_5"),i("rpe_desc_6"),i("rpe_desc_7"),i("rpe_desc_8"),i("rpe_desc_9"),i("rpe_desc_10")];return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("hr",{className:"border-t border-indigo-200"}),Object(_.jsxs)(C,{children:[Object(_.jsxs)("span",{className:"uppercase text-sm tracking-wider text-indigo-700",children:[i("rpe"),Object(_.jsx)("button",{onClick:function(){return p(!b)},children:Object(_.jsx)(j.g,{className:"inline ml-1 mb-1"})})]}),Object(_.jsx)("input",{className:"rpe val-".concat(o),type:"range",min:"1",value:o,onChange:function(e){return n||u(e.target.value)},max:"10",step:"1"}),Object(_.jsx)("ul",{className:"tracks flex w-full justify-between text-xs -mt-1 text-indigo-700",children:Array.from(Array(10).keys()).map((function(e){return Object(_.jsx)("li",{children:e+1},e)}))}),b&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("hr",{className:"mt-2 border-t border-indigo-200"}),Object(_.jsx)("h4",{className:"text-xs font-semibold mb-1 mt-2 text-indigo-700",children:m[o-1]}),Object(_.jsx)("p",{className:"text-xs text-indigo-700",children:v[o-1]})]})]})]})}r(53);function ee(e){var t=e.id,r=e.name,n=e.sets,a=e.isFirst,i=void 0!==a&&a,s=e.isLast,c=void 0!==s&&s,o=e.isActive,u=void 0!==o&&o,l=e.isComplete,d=void 0!==l&&l,f=e.isReadOnly,b=void 0!==f&&f,p=e.defaultRPE,m=void 0===p?5:p,v=e.isWorkoutComplete,h=void 0!==v&&v,g=e.activeSetId,O=void 0===g?null:g,y=e.dispatch,k=void 0===y?function(){}:y,E=x().t,w=function(e){k({type:"UPDATE_ACTIVE_SET",payload:{exerciseId:t,setId:e}})},N=function(e){k({type:"MOVE_EXERCISE",payload:{exerciseId:t,factor:e}})};return Object(_.jsxs)("div",{className:"exercise relative","data-id":t,children:[h||b||Object(_.jsxs)("div",{className:"absolute top-1 right-1 text-indigo-500",children:[Object(_.jsx)("button",{disabled:c,onClick:function(){return N(1)},className:"disabled:opacity-50 p-2",children:Object(_.jsx)(j.d,{})}),Object(_.jsx)("button",{disabled:i,onClick:function(){return N(-1)},className:"disabled:opacity-50 p-2",children:Object(_.jsx)(j.e,{})})]}),Object(_.jsx)(S,{isActive:u,children:Object(_.jsxs)(T,{children:[Object(_.jsxs)(A,{className:"exercise-name",children:[Object(_.jsx)(j.f,{className:"inline text-xl mb-1"})," ",r]}),n.length?n.map((function(e){return Object(_.jsx)(Z,{id:e.id,exerciseId:t,defaultDurationTime:e.defaultDurationTime,defaultWeight:e.defaultWeight,defaultRestTime:e.defaultRestTime,defaultReps:e.defaultReps,onClick:function(){return w(e.id)},onActivateSet:w,isActive:e.id===O,isReadOnly:b,stage:e.stage,dispatch:k},e.id)})):Object(_.jsx)(R,{children:E("no_sets")}),d&&n.length>0&&Object(_.jsx)($,{defaultRPE:m,isReadOnly:b})]})}),h||b||Object(_.jsxs)(L,{children:[u&&null!==O&&Object(_.jsx)(D,{onClick:function(){k({type:"REMOVE_SET",payload:{exerciseId:t}})},children:E("remove_set")}),Object(_.jsx)(D,{onClick:function(){k({type:"ADD_SET",payload:{exerciseId:t}})},children:E("add_set")})]})]})}var te=r(40),re=r(39);function ne(){return crypto.getRandomValues(new Uint32Array(1))[0].toString(16)}function ae(e,t){var r=Object(re.cloneDeep)(e);switch(t.type){case"SET_WORKOUT":return t.payload;case"ADD_SET":return function(e,t){var r=t.exerciseId,n=e.exercises.find((function(e){return e.id===r})),a=ne();return n.sets=[].concat(Object(te.a)(n.sets),[{id:a,stage:"IDLE"}]),e.activeSetId=a,e}(r,t.payload);case"REMOVE_SET":return function(e,t){var r=t.exerciseId,n=e.exercises.find((function(e){return e.id===r})),a=n.sets.findIndex((function(t){return t.id===e.activeSetId}));return-1!==a&&(n.sets.splice(a,1),e.activeSetId=null),e}(r,t.payload);case"UPDATE_ACTIVE_SET":return function(e,t){var r=t.setId,n=t.exerciseId;return e.activeSetId=r,e.activeExerciseId=n,e}(r,t.payload);case"UPDATE_SET_STAGE":return function(e,t){var r=e.exercises.find((function(t){return t.id===e.activeExerciseId})),n=r.sets.findIndex((function(t){return t.id===e.activeSetId}));if(-1===n)return e;var a=r.sets[n].stage,i=t||function(e){var t=["IDLE","ACTIVE","RESTING","COMPLETE"],r=t.findIndex((function(t){return t===e}));return t[(r+1)%t.length]}(a);if("COMPLETE"===i&&!t){var s=(n+1)%r.sets.length;e.activeSetId=s>0?r.sets[(n+1)%r.sets.length].id:null}return r.sets[n].stage=i,v(r)||(e.activeSetId=null),e}(r);case"COMPLETE_EXERCISE":return function(e){var t,r=(e.exercises.findIndex((function(t){return t.id===e.activeExerciseId}))+1)%e.exercises.length,n=e.exercises[r];return e.activeExerciseId=n.id,e.activeSetId=(null===(t=n.sets[0])||void 0===t?void 0:t.id)||null,e}(r);case"ADD_EXERCISE":return function(e,t){var r=t.name;return e.exercises.push({id:ne(),name:r,sets:[]}),e}(r,t.payload);case"COMPLETE_WORKOUT":return function(e){return e.isComplete=!0,e}(r);case"MOVE_EXERCISE":return function(e,t){var r=t.exerciseId,n=t.factor,a=e.exercises.findIndex((function(e){return e.id===r}));if(-1===a)return e;var i=Math.min(Math.max(0,a+n),e.exercises.length-1),s=e.exercises[a],c=e.exercises[i];return e.exercises[a]=c,e.exercises[i]=s,e}(r,t.payload);default:throw new Error}}function ie(e){var t=x().t,r=e.id,n=e.createNew,i=void 0===n||n,s=G(),c=J(),u=c.requestNotificationPermission,d=c.hasAskedPermission,f=Object(a.useReducer)(ae,null),b=Object(l.a)(f,2),p=b[0],m=b[1];return Object(a.useEffect)((function(){null===s||void 0===s||s.loadWorkoutLogById(r,i).then((function(e){m({type:"SET_WORKOUT",payload:e})}))}),[s]),p?Object(_.jsxs)("div",{children:[Object(_.jsxs)("header",{className:"flex items-center pt-4",children:[Object(_.jsx)("h2",{className:"workout-name text-2xl text-indigo-800 font-semibold px-3 pr-2",children:p.name}),d||Object(_.jsx)("button",{onClick:u,className:"p-1 text-base text-indigo-800",children:Object(_.jsx)(j.b,{className:"inline"})}),Object(_.jsx)(o.b,{className:"text-blue-500 ml-auto px-3",to:"/",children:t("close")})]}),Object(_.jsxs)("main",{children:[p.exercises.length>0?Object(_.jsx)("ul",{className:"flex flex-col space-y-4 p-3",children:p.exercises.map((function(e,t){return Object(_.jsx)("li",{children:Object(_.jsx)(ee,{id:e.id,isFirst:0===t,isWorkoutComplete:p.isComplete,isLast:t===p.exercises.length-1,isActive:e.id===p.activeExerciseId&&i,isComplete:!v(e),isReadOnly:!i||p.isComplete,name:e.name,sets:e.sets,defaultRPE:e.rpe,activeSetId:p.activeSetId,dispatch:m})},e.id)}))}):Object(_.jsx)("p",{className:"px-3 my-2 text-indigo-500",children:t("no_exercise")}),p.isComplete||!i||Object(_.jsx)(Q,{dispatch:m})]}),Object(_.jsx)(H,{isReadOnly:!i,state:p,dispatch:m})]}):null}var se={pt:f.a,en:b.a};function ce(){var e=Object(a.useState)([]),t=Object(l.a)(e,2),r=t[0],n=t[1],i=G(),s=x(),c=s.t,u=s.language;Object(a.useEffect)((function(){null===i||void 0===i||i.getAllData("logs").then(n)}),[i]);var f=function(){var e=Object(V.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===i||void 0===i||i.eraseLogEntry(t),n(r.filter((function(e){return e.persistenceKey!==t})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(!r.length)return null;var b=se[u],p={};return b&&(p.locale=b),Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{className:"workout-name text-2xl text-blue-800 font-semibold px-3 pt-4",children:c("history")}),Object(_.jsx)("ul",{className:"flex flex-col space-y-4 p-3",children:r.map((function(e){return Object(_.jsxs)(o.b,{to:{pathname:"/viewWorkout",search:"?id=".concat(e.persistenceKey)},className:"p-2 border border-blue-200 relative flex flex-wrap bg-blue-50 rounded-xl",children:[Object(_.jsx)("button",{onClick:function(t){f(e.persistenceKey),t.preventDefault()},className:"absolute p-2 top-0 right-0 text-blue-400",children:Object(_.jsx)(j.m,{})}),Object(_.jsxs)("h2",{className:"text-blue-700 w-full text-md",children:[Object(_.jsx)(j.f,{className:"-mt-1 inline text-lg"})," ",e.name]}),Object(_.jsx)("p",{className:"text-blue-600 text-sm",children:Object(d.a)(e.date,"PPp",p)})]},e.persistenceKey)}))})]})}function oe(e){var t=x().t,r=Object(a.useState)(""),n=Object(l.a)(r,2),i=n[0],s=n[1],c=e.onAddWorkout,o=void 0===c?function(){}:c;return Object(_.jsx)(I,{onSubmit:function(e){e.preventDefault(),o(i),s("")},onChange:function(e){return s(e.target.value)},placeholder:t("workout_name"),label:t("add_workout"),value:i})}var ue=r(57),le={pt:f.a,en:b.a};function de(e){var t=e.name,r=e.onRemoveWorkout,n=e.id,i=Object(a.useState)(null),s=Object(l.a)(i,2),c=s[0],u=s[1],d=G(),f=x(),b=f.t,p=f.language;Object(a.useEffect)(Object(V.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===d||void 0===d||d.getLastLogEntry(n).then((function(e){e&&u(e.date)}));case 1:case"end":return e.stop()}}),e)}))),[d]);var m=le[p],v={};return m&&(v.locale=m),Object(_.jsxs)(o.b,{to:{pathname:"/newWorkout",search:"?id=".concat(n)},className:"p-2 border border-indigo-200 relative flex flex-wrap bg-indigo-50 rounded-xl",children:[Object(_.jsx)("button",{onClick:function(e){r(n),e.preventDefault()},className:"p-2 absolute top-0 right-0 text-indigo-400",children:Object(_.jsx)(j.m,{})}),Object(_.jsxs)("h2",{className:"text-indigo-700 w-full text-md",children:[Object(_.jsx)(j.f,{className:"-mt-1 inline text-lg"})," ",t]}),c&&Object(_.jsxs)("p",{className:"text-indigo-600 text-sm",children:[b("last_run"),": ",Object(ue.a)(c,new Date,v)]})]})}function fe(){var e=G(),t=x().t,r=Object(a.useState)([]),n=Object(l.a)(r,2),i=n[0],s=n[1];Object(a.useEffect)((function(){null===e||void 0===e||e.getAllData("workouts").then(s)}),[e]);var c=function(){var t=Object(V.a)(M.a.mark((function t(r){var n;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={id:ne(),name:r,exercises:[]},!e){t.next=4;break}return t.next=4,e.saveWorkout(n);case 4:s(i.concat([n]));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o=function(){var r=Object(V.a)(M.a.mark((function r(n){return M.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!window.confirm(t("confirm_delete"))){r.next=6;break}if(!e){r.next=5;break}return r.next=5,e.eraseWorkout(n);case 5:s(i.filter((function(e){return e.id!==n})));case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{className:"workout-name text-2xl text-indigo-800 font-semibold px-3 pt-4",children:t("workouts_list")}),i.length>0?Object(_.jsx)("ul",{className:"flex flex-col space-y-4 p-3",children:i.map((function(e){return Object(_.jsx)(de,{id:e.id,name:e.name,onRemoveWorkout:o},e.id)}))}):Object(_.jsx)("p",{className:"px-3 my-2 text-indigo-500",children:t("no_workout")}),Object(_.jsx)(oe,{onAddWorkout:c})]})}var be=function(){var e=function(e){var t=new URLSearchParams(e.location.search).get("id"),r="/newWorkout"===e.match.path;return"/viewWorkout"===e.match.path&&(t=Number(t)),Object(_.jsx)(ie,{id:t,createNew:r})};return Object(_.jsx)(y,{children:Object(_.jsx)(o.a,{basename:"/WorkoutTracker",children:Object(_.jsxs)(u.c,{children:[Object(_.jsxs)(u.a,{exact:!0,path:"/",children:[Object(_.jsx)(fe,{}),Object(_.jsx)(ce,{})]}),Object(_.jsx)(u.a,{path:"/viewWorkout",render:e}),Object(_.jsx)(u.a,{path:"/newWorkout",render:e})]})})})};c.a.render(Object(_.jsx)(i.a.StrictMode,{children:Object(_.jsx)(be,{})}),document.getElementById("root"))}},[[55,1,2]]]);
//# sourceMappingURL=main.46be60ed.chunk.js.map