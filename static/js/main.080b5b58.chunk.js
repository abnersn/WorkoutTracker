(this["webpackJsonpworkout-tracker"]=this["webpackJsonpworkout-tracker"]||[]).push([[0],{46:function(e,t,r){},53:function(e,t,r){},55:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"en",(function(){return p})),r.d(n,"pt",(function(){return m}));var i=r(1),a=r.n(i),s=r(36),c=r.n(s),o=(r(46),r(16)),u=r(7),l=r(4),d=r(56),f=r(22),b=r(17),p={no_exercise:"No exercises to list.",start:"Start",close:"Close",complete:"Complete",reset:"Reset",sets:"Sets",reps:"Reps",history:"History",view:"View",last_run:"Last run",time:"Time",rest:"Rest",weight:"Weight",confirm_delete:"Are you sure you want to delete this workout?",save_progress:"Would you like to save your progress?",erase_workout:"Are you sure you want to erase the current workout?",back:"Back",reset_workout:"Reset workout",finish_workout:"Complete",finish_exercise:"Finish exercise",start_workout:"Start workout",add_exercise:"Add exercise",exercise_name:"Exercise name",no_sets:"No sets for this exercise.",remove_set:"Remove set",remove_exercise:"Remove exercise",add_set:"Add set",rpe_title_1:"Very light activity",rpe_title_2:"Light activity",rpe_title_3:"Light activity",rpe_title_4:"Moderate activity",rpe_title_5:"Moderate activity",rpe_title_6:"Moderate activity",rpe_title_7:"Vigorous activity",rpe_title_8:"Vigorous activity",rpe_title_9:"Very hard activity",rpe_title_10:"Max effort activity",rpe_desc_1:"Hardly any exertion, but more than sleeping, watching TV, etc.",rpe_desc_2:"Could mantain for hours. Easy to breathe and carry a conversation.",rpe_desc_3:"Could mantain for hours. Easy to breathe and carry a conversation.",rpe_desc_4:"Breathing heavily, can mantain a conversation, but more challenging.",rpe_desc_5:"Breathing heavily, can mantain a conversation, but more challenging.",rpe_desc_6:"Breathing heavily, can mantain a conversation, but more challenging.",rpe_desc_7:"Almost uncofortable, short of breath, can speak a sentence.",rpe_desc_8:"Almost uncofortable, short of breath, can speak a sentence.",rpe_desc_9:"Very difficult to mantain, can barely breathe, can speak a few words",rpe_desc_10:"Almost impossible to keep going. Out of breath, unable to talk.",rpe:"Rate of perceived exertion ",workouts_list:"Workouts list",workout_name:"Workout name",add_workout:"Add workout",remove_workout:"Remove workout",no_workout:"No workout",load_error:"Could not load data",times_up:"Rest time's up!",duration_up:"Exercise time's up!",persist_error:"Could not save data",start_workout_from_history:"Use workout"},m={no_exercise:"Nenhum exerc\xedcio para listar.",start:"Iniciar",close:"Fechar",complete:"Completar",reset:"Reiniciar",sets:"S\xe9ries",reps:"Repet.",time:"Tempo",history:"Hist\xf3rico",view:"Ver",last_run:"\xdaltima vez",rest:"Descanso",weight:"Peso",confirm_delete:"Tem certeza que deseja remover este treino?",save_progress:"Voc\xea gostaria de salvar seu progresso?",erase_workout:"Tem certeza que deseja apagar o treino atual?",back:"Voltar",reset_workout:"Apagar treino",finish_workout:"Completar",finish_exercise:"Concluir exerc\xedcio",start_workout:"Iniciar treino",add_exercise:"Adicionar exerc\xedcio",exercise_name:"Nome do exerc\xedcio",no_sets:"Nenhuma s\xe9rie para este exerc\xedcio.",remove_set:"Remover s\xe9rie",remove_exercise:"Remover exerc\xedcio",add_set:"Adicionar s\xe9rie",rpe_title_1:"Atividade muito leve",rpe_title_2:"Atividade leve",rpe_title_3:"Atividade leve",rpe_title_4:"Atividade moderada",rpe_title_5:"Atividade moderada",rpe_title_6:"Atividade moderada",rpe_title_7:"Atividade vigorosa",rpe_title_8:"Atividade vigorosa",rpe_title_9:"Atividade muito dif\xedcil",rpe_title_10:"Esfor\xe7o m\xe1ximo",rpe_desc_1:"Quase nenhum esfor\xe7o, por\xe9m mais que assistir TV ou dormir.",rpe_desc_2:"Conseguiria manter por horas. Respira facilmente e consegue conversar normalmente.",rpe_desc_3:"Conseguiria manter por horas. Respira facilmente e consegue conversar normalmente.",rpe_desc_4:"Respira com dificuldade, conseguiria manter uma conversa, mas seria mais dif\xedcil.",rpe_desc_5:"Respira com dificuldade, conseguiria manter uma conversa, mas seria mais dif\xedcil.",rpe_desc_6:"Respira com dificuldade, conseguiria manter uma conversa, mas seria mais dif\xedcil.",rpe_desc_7:"Quase desconfort\xe1vel, falta f\xf4lego, consegue dizer uma frase no m\xe1ximo.",rpe_desc_8:"Quase desconfort\xe1vel, falta f\xf4lego, consegue dizer uma frase no m\xe1ximo.",rpe_desc_9:"Muito dif\xedcil de manter, mal consegue respirar, consegue dizer apenas algumas palavras.",rpe_desc_10:"Imposs\xedvel continuar, totalmente sem f\xf4lego, n\xe3o consegue falar.",rpe:"Escala de esfor\xe7o ",workouts_list:"Lista de treinos",workout_name:"Nome do treino",add_workout:"Adicionar treino",remove_workout:"Remover treino",no_workout:"Nenhum treino dispon\xedvel",times_up:"Descanso acabou!",duration_up:"Exerc\xedcio acabou!",load_error:"N\xe3o foi poss\xedvel carregar os dados",persist_error:"N\xe3o foi poss\xedvel salvar as altera\xe7\xf5es",start_workout_from_history:"Usar treino"};function x(){var e=Object(i.useState)("en"),t=Object(l.a)(e,2),r=t[0],a=t[1];Object(i.useEffect)((function(){var e=window.navigator.language.split("-")[0];["en","pt"].includes(e)?a(e):a("en")}),[]);var s=p;return{t:function(e){return n[r][e]||s[e]||e},language:r}}var v=r(6);function j(e){return e.sets.some((function(e){return"COMPLETE"!==e.stage}))}function h(e){if(e<0)return"-".concat(h(Math.abs(e)));var t=function(e){return"".concat(e%60).padStart(2,"0")},r=Math.floor(e/60);if(0===r)return"".concat(e);if(r>=60){var n=Math.floor(r/60);return"".concat(n,":").concat(t(r),":").concat(t(e))}return"".concat(r,":").concat(t(e))}var g=r(11),O=r(28),_=r(0);function y(e){var t=e.children;return Object(_.jsx)("div",{className:"container bg-white max-w-5xl min-h-screen m-auto border shadow-md place-self-center pb-24",children:t})}function E(e){var t=e.children;return Object(_.jsx)("div",{className:"fixed flex justify-center bottom-0 w-screen left-0",children:Object(_.jsx)("div",{className:"flex justify-end items-center border-t border-indigo-200 bg-white w-full max-w-5xl p-3 pb-8",children:t})})}function k(e){var t=e.Icon,r=e.type,n=void 0===r?"neutral":r,i=e.label,a=Object(O.a)(e,["Icon","type","label"]),s={primary:"bg-blue-500 ml-2 border-blue-600 focus:ring-blue-200 active:bg-blue-700",neutral:"bg-indigo-500 ml-2 border-indigo-600 focus:ring-indigo-200 active:bg-indigo-700",success:"bg-green-500 ml-2 border-green-600 focus:ring-green-200 active:bg-green-700"},c=s[n]||s.neutral;return Object(_.jsxs)("button",Object(g.a)(Object(g.a)({},a),{},{className:"border flex uppercase focus:ring-2 text-sm items-center text-white px-3 py-2 rounded-md ".concat(c),children:[t&&Object(_.jsx)(t,{className:"mr-1 text-lg"})," ",i]}))}function w(e){var t=e.type,r=void 0===t?"neutral":t,n=e.children,i={primary:"border-blue-500 text-blue-700",neutral:"border-indigo-500 text-indigo-700",success:"border-green-500 text-green-700"},a=i[r]||i.neutral;return Object(_.jsx)("div",{className:"text-xl mr-auto border-l-2 pl-2 bg-white ".concat(a),children:n})}function N(e){var t=e.small,r=void 0!==t&&t,n=e.className,i=e.children,a=r?"text-xs":"text-sm";return Object(_.jsx)("p",{className:"".concat(a," uppercase tracking-wider ").concat(n),children:i})}function I(e){var t=e.onSubmit,r=e.value,n=e.onChange,i=e.placeholder,a=e.label;return Object(_.jsxs)("form",{onSubmit:t,className:"m-3 pt-3 border-t border-indigo-200",children:[Object(_.jsx)("div",{className:"flex p-2 items-center bg-indigo-50 rounded-xl border border-indigo-200",children:Object(_.jsx)("input",{required:!0,value:r,onChange:n,className:"text-indigo-800 px-2 w-2 flex-1 py-1 rounded border border-indigo-200 placeholder-indigo-400 focus:ring-2 focus:ring-indigo-200",type:"text",placeholder:i})}),Object(_.jsx)("div",{className:"flex justify-end mt-1",children:Object(_.jsxs)("button",{className:"text-indigo-500 text-sm px-1",children:[" ",a]})})]})}function S(e){var t=e.isActive,r=void 0!==t&&t,n=e.type,i=void 0===n?"neutral":n,a=e.children,s={primary:"border-blue-200 bg-blue-50 ".concat(r?"ring-2 ring-blue-200":""),neutral:"border-indigo-200 bg-indigo-50 ".concat(r?"ring-2 ring-indigo-200":""),success:"border-green-200 bg-green-50 ".concat(r?"ring-2 ring-green-200":"")},c=s[i]||s.neutral;return Object(_.jsx)("div",{className:"p-2 border ".concat(c," rounded-xl"),children:a})}function T(e){var t=e.children;return Object(_.jsx)("ul",{className:"flex flex-col space-y-3",children:t})}function C(e){var t=e.isActive,r=e.children,n=e.className,i=Object(O.a)(e,["isActive","children","className"]),a=t?"ring-2 ring-indigo-200 border-indigo-400":"";return Object(_.jsx)("div",Object(g.a)(Object(g.a)({},i),{},{className:"bg-white p-2 rounded-md shadow border border-indigo-200 ".concat(a," ").concat(n),children:r}))}function R(e){var t=e.children,r=e.className,n=e.onClick;return Object(_.jsx)("button",{onClick:n,className:"text-lg self-start font-semibold text-indigo-800 select-none cursor-pointer ".concat(r),children:t})}function A(e){var t=e.children;return Object(_.jsx)("p",{className:"text-indigo-500 text-sm pb-1",children:t})}function D(e){var t=e.children,r=Object(O.a)(e,["children"]);return Object(_.jsx)("button",Object(g.a)(Object(g.a)({},r),{},{className:"text-indigo-500 text-sm px-1",children:t}))}function L(e){var t=e.children;return Object(_.jsx)("div",{className:"flex justify-end mt-1 space-x-4",children:t})}var P=r(19),W=r(5),M=r.n(W),V=r(9),q=r(37),U=r(38),F=r(41),B=function(){function e(){Object(q.a)(this,e),this.db=null}return Object(U.a)(e,[{key:"init",value:function(){var e=Object(V.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("indexedDB"in window){e.next=3;break}return alert("This app needs indexedDb support to run."),e.abrupt("return");case 3:return e.next=5,Object(F.a)("workoutTracker",1,{upgrade:function(e){e.objectStoreNames.contains("workouts")||e.createObjectStore("workouts",{keyPath:"id"}),e.objectStoreNames.contains("logs")||e.createObjectStore("logs",{autoIncrement:!0})}});case 5:this.db=e.sent;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAllData",value:function(){var e=Object(V.a)(M.a.mark((function e(t){var r,n,i,a,s;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],n=this.db.transaction(t,"readonly"),i=n.objectStore(t),e.next=5,i.openCursor();case 5:a=e.sent;case 6:if(!a){e.next=15;break}return(s=a.value).persistenceKey=a.key,r.push(s),e.next=12,a.continue();case 12:a=e.sent,e.next=6;break;case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getData",value:function(e,t){return this.db.transaction(e,"readonly").objectStore(e).get(t)}},{key:"runInWorkouts",value:function(e){var t=this.db.transaction("workouts","readwrite");return e(t.objectStore("workouts")),t.complete}},{key:"runInLogs",value:function(e){var t=this.db.transaction("logs","readwrite");return e(t.objectStore("logs")),t.complete}},{key:"saveLogEntry",value:function(e){return this.runInLogs((function(t){return t.add(e)}))}},{key:"eraseLogEntry",value:function(e){return this.runInLogs((function(t){return t.delete(e)}))}},{key:"saveWorkout",value:function(e){return this.runInWorkouts((function(t){return t.add(e)}))}},{key:"eraseWorkout",value:function(e){return this.runInWorkouts((function(t){return t.delete(e)}))}},{key:"getLastLogEntry",value:function(){var e=Object(V.a)(M.a.mark((function e(t){var r,n;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAllData("logs");case 2:return r=e.sent,n=r.filter((function(e){return e.id===t})).sort((function(e,t){return t.date-e.date})),e.abrupt("return",n[0]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadNewWorkout",value:function(){var e=Object(V.a)(M.a.mark((function e(t,r){var n,i,a,s,c,o;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData(r?"logs":"workouts",t);case 2:(n=e.sent).date=new Date,n.isComplete=!1,n.duration=0,i=Object(P.a)(n.exercises);try{for(i.s();!(a=i.n()).done;){s=a.value,c=Object(P.a)(s.sets);try{for(c.s();!(o=c.n()).done;)o.value.stage="IDLE"}catch(u){c.e(u)}finally{c.f()}}}catch(u){i.e(u)}finally{i.f()}return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"loadWorkoutFromLogs",value:function(){var e=Object(V.a)(M.a.mark((function e(t){var r,n,i,a,s,c;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("logs",t);case 2:(r=e.sent).date=new Date(r.date),n=Object(P.a)(r.exercises);try{for(n.s();!(i=n.n()).done;){a=i.value,s=Object(P.a)(a.sets);try{for(s.s();!(c=s.n()).done;)c.value.stage="COMPLETE"}catch(o){s.e(o)}finally{s.f()}}}catch(o){n.e(o)}finally{n.f()}return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveWorkoutTemplate",value:function(){var e=Object(V.a)(M.a.mark((function e(t,r){var n;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("workouts",t);case 2:return(n=e.sent).exercises=r,e.abrupt("return",this.runInWorkouts((function(e){return e.put(n)})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"loadWorkoutLogById",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?this.loadNewWorkout(e,r):this.loadWorkoutFromLogs(e)}}]),e}();function X(){var e=Object(i.useState)(null),t=Object(l.a)(e,2),r=t[0],n=t[1];return Object(i.useEffect)((function(){var e=new B;e.init().then((function(){return n(e)}))}),[]),r}function G(e){var t={id:e,isComplete:!0,activeSetId:null,activeExerciseId:null};t.date=new Date,t.name=document.querySelector(".workout-name").textContent.trim(),t.duration=Number(document.querySelector(".workout-duration").dataset.value),t.exercises=[];var r,n=document.querySelectorAll(".exercise"),i=Object(P.a)(n);try{for(i.s();!(r=i.n()).done;){var a,s=r.value,c={};c.name=s.querySelector(".exercise-name").textContent.trim(),c.id=s.dataset.id,c.type=s.dataset.type,c.sets=[];var o,u=s.querySelectorAll(".set-display"),l=Object(P.a)(u);try{for(l.s();!(o=l.n()).done;){var d,f,b=o.value,p={};p.id=b.dataset.id,p.defaultDurationTime=Number(null===(d=b.querySelector(".time .value"))||void 0===d||null===(f=d.dataset)||void 0===f?void 0:f.value),p.defaultReps=Number(b.querySelector(".reps .value").dataset.value),p.defaultWeight=Number(b.querySelector(".weight .value").dataset.value),p.defaultRestTime=Number(b.querySelector(".rest .value").dataset.value),p.stage="COMPLETE",c.sets.push(p)}}catch(m){l.e(m)}finally{l.f()}c.rpe=Number(null===(a=s.querySelector(".rpe"))||void 0===a?void 0:a.value)||5,t.exercises.push(c)}}catch(m){i.e(m)}finally{i.f()}return t}var K={pt:f.a,en:b.a};function z(e){var t=e.stage,r=e.onClick,n=void 0===r?function(){}:r,i=x().t,a={IDLE:i("start"),ACTIVE:i("rest"),RESTING:i("complete"),COMPLETE:i("reset")},s={IDLE:v.i,ACTIVE:v.h,RESTING:v.b,COMPLETE:v.j},c=a[t],o=s[t],u={IDLE:"neutral",ACTIVE:"neutral",RESTING:"neutral",COMPLETE:"primary"}[t];return Object(_.jsx)(k,{onClick:n,type:u,label:c,Icon:o})}function H(e){var t,r=e.state,n=e.dispatch,a=e.isReadOnly,s=e.timer,c=e.loadedId,u=x(),f=u.t,b=u.language,p=X(),m=Object(i.useState)(!1),g=Object(l.a)(m,2),O=g[0],y=g[1],I=[null,null],S=r.exercises.find((function(e){return e.id===r.activeExerciseId})),T=S?S.sets.find((function(e){return e.id===r.activeSetId})):null,C=Boolean(T),R=r.exercises.length>0,A=(null===(t=r.exercises[0])||void 0===t?void 0:t.sets.length)>0;a||O?I[0]=Object(_.jsx)(o.b,{to:{pathname:"/newWorkout",search:"id=".concat(c,"&fromLogs=true")},children:Object(_.jsx)(k,{type:"primary",label:f("start_workout_from_history"),Icon:v.i})}):s.isRunning?(C&&(I[0]=Object(_.jsx)(z,{onClick:function(){n({type:"UPDATE_SET_STAGE"})},stage:T.stage})),r.exercises.some(j)?j(S)||(I[1]=Object(_.jsx)(k,{type:"success",label:f("finish_exercise"),Icon:v.m,onClick:function(){n({type:"COMPLETE_EXERCISE"})}})):I[1]=Object(_.jsx)(k,{type:"success",label:f("finish_workout"),Icon:v.p,onClick:function(){if(window.confirm(f("save_progress"))){var e=G(r.id);null===p||void 0===p||p.saveLogEntry(e),y(!0),s.pause(),n({type:"COMPLETE_WORKOUT"})}}})):R&&A&&!O&&(I[0]=Object(_.jsx)(k,{type:"primary",label:f("start_workout"),onClick:function(){var e,t,i;s.play(),n({type:"UPDATE_ACTIVE_SET",payload:{exerciseId:null===(e=r.exercises[0])||void 0===e?void 0:e.id,setId:null===(t=r.exercises[0])||void 0===t||null===(i=t.sets[0])||void 0===i?void 0:i.id}}),n({type:"UPDATE_SET_STAGE"})},Icon:v.i}));var D=s.isRunning||!O?"neutral":"success",L=K[b],P={};L&&(P.locale=L);var W=r.date||new Date;return Object(_.jsxs)(E,{children:[Object(_.jsxs)(w,{type:D,children:[Object(_.jsx)(v.n,{className:"inline -mt-1 mr-1 -ml-1"}),Object(_.jsx)("time",{className:"workout-duration","data-value":s.value,children:h(s.value)}),Object(_.jsx)(N,{small:!0,children:Object(d.a)(W,"PP",P)})]}),I[0]," ",I[1]]})}function Q(e){var t=x().t,r=Object(i.useState)(""),n=Object(l.a)(r,2),a=n[0],s=n[1],c=e.dispatch;return Object(_.jsx)(I,{onSubmit:function(e){e.preventDefault(),s(""),c({type:"ADD_EXERCISE",payload:{name:a}})},onChange:function(e){return s(e.target.value)},placeholder:t("exercise_name"),label:t("add_exercise"),value:a})}function J(){var e=Object(i.useState)(!1),t=Object(l.a)(e,2),r=t[0],n=t[1],a=Object(i.useState)(!1),s=Object(l.a)(a,2),c=s[0],o=s[1];if(!("Notification"in window))return{hasAskedPermission:!0,notify:function(){},hasNotificationPermission:c,requestNotificationPermission:function(){}};function u(){return(u=Object(V.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Notification.requestPermission();case 2:t=e.sent,o("granted"===t),n(!0);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(i.useEffect)((function(){o("granted"===Notification.permission),n("default"!==Notification.permission)}),[]),{hasAskedPermission:r,notify:function(e){new Notification("Workout tracker",{body:e,vibrate:!0})},hasNotificationPermission:c,requestNotificationPermission:function(){return u.apply(this,arguments)}}}function Y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"timer",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=Object(i.useState)(t),a=Object(l.a)(n,2),s=a[0],c=a[1],o=Object(i.useState)(!1),u=Object(l.a)(o,2),d=u[0],f=u[1],b=Object(i.useState)("visible"!==document.visibilityState),p=Object(l.a)(b,2),m=p[0],x=p[1],v=window.sessionStorage,j=function(){return f(!0)},h=function(){return f(!1)};return Object(i.useEffect)((function(){if(d&&!m){var e=setInterval((function(){c((function(e){return Math.max(e+r,0)}))}),1e3);return function(){return clearInterval(e)}}}),[d,m]),Object(i.useEffect)((function(){var e=function(){x("visible"!==document.visibilityState)};return window.addEventListener("visibilitychange",e),function(){return window.removeEventListener("visibilitychange",e)}}),[]),Object(i.useEffect)((function(){if(m)v.setItem(e,Date.now());else if(d){var t=Number(v.getItem(e));if(t&&d){var n=Math.floor((Date.now()-t)/(1e3*r));c((function(e){return Math.max(e+n,0)}))}}}),[m]),{play:j,pause:h,value:s,isRunning:d,set:c}}function Z(e){var t=e.inputProps,r=e.labelText,n=e.value,i=void 0===n?null:n,a=e.formatFunction,s=void 0===a?function(e){return e}:a,c=e.type,o=void 0===c?"neutral":c,u=e.isEdit,l=void 0!==u&&u,d=e.onToggleEdit,f=void 0===d?function(){}:d,b=e.onChange,p=void 0===b?function(){}:b,m={primary:"text-blue-800 bg-blue-50 border-blue-200 focus:ring-blue-100",neutral:"text-indigo-800 bg-indigo-50 border-indigo-200 focus:ring-indigo-100",success:"text-green-800 bg-green-50 border-green-200 focus:ring-green-100",danger:"text-red-800 bg-red-50 border-red-200 focus:ring-red-100",highlight:"text-cyan-800 bg-cyan-50 border-cyan-200 focus:ring-cyan-100"};return Object(_.jsxs)("label",{className:{primary:"text-blue-800",neutral:"text-indigo-800",success:"text-green-800",danger:"text-red-800",highlight:"text-cyan-800"}[o],children:[Object(_.jsx)(N,{className:"mb-1",children:r}),l?Object(_.jsx)("input",Object(g.a)(Object(g.a)({},t),{},{className:"block tabuler-nums w-full px-1 rounded shadow-sm border focus:ring-2 ".concat(m[o]),value:i,autoFocus:!0,onFocus:function(e){return e.target.select()},onBlur:function(){return l&&f(!1)},onChange:function(e){return p(Number(e.target.value))}})):Object(_.jsx)("span",{"data-value":i,tabIndex:0,onFocus:function(){return l||f(!0)},className:"value block tabuler-nums w-full px-1 rounded shadow-sm border ".concat(m[o]),children:s(Number(i))})]})}function $(e){var t=e.id,r=e.exerciseType,n=e.exerciseId,a=e.defaultDurationTime,s=void 0===a?0:a,c=e.defaultRestTime,o=void 0===c?30:c,u=e.defaultReps,d=void 0===u?8:u,f=e.defaultWeight,b=void 0===f?10:f,p=e.isReadOnly,m=void 0!==p&&p,v=e.onClick,j=void 0===v?function(){}:v,g=e.dispatch,O=void 0===g?function(){}:g,y=e.isActive,E=void 0===y||y,k=e.stage,w=void 0===k?"IDLE":k,N=Y("durationTimer",s,-1),I=Y("restTimer",o,-1),S=Object(i.useState)(!1),T=Object(l.a)(S,2),R=T[0],A=T[1],D=Object(i.useState)(!0),L=Object(l.a)(D,2),P=L[0],W=L[1],M=Object(i.useState)(d),V=Object(l.a)(M,2),q=V[0],U=V[1],F=Object(i.useState)(b),B=Object(l.a)(F,2),X=B[0],G=B[1],K=Object(i.useState)(!1),z=Object(l.a)(K,2),H=z[0],Q=z[1],$=Object(i.useState)(!1),ee=Object(l.a)($,2),te=ee[0],re=ee[1],ne=Object(i.useState)(!1),ie=Object(l.a)(ne,2),ae=ie[0],se=ie[1],ce=Object(i.useState)(!1),oe=Object(l.a)(ce,2),ue=oe[0],le=oe[1],de=J().notify,fe=Object(i.useRef)(),be=x().t;Object(i.useEffect)((function(){"ACTIVE"===w&&(A(!1),W(!1))}),[w]),Object(i.useEffect)((function(){(H||te||ae||ue)&&O({type:"UPDATE_ACTIVE_SET",payload:{setId:t,exerciseId:n}})}),[O,H,te,ue,ae,t,n]),Object(i.useEffect)((function(){"COMPLETE"===w&&I.value<0&&I.set((function(e){return o+Math.abs(e)}))}),[w,o]),Object(i.useEffect)((function(){"IDLE"===w&&"COMPLETE"===fe.current&&(N.set(0),I.set(o),U(d),G(b))}),[o,d,b,w]),Object(i.useEffect)((function(){fe.current=w}),[w]),Object(i.useEffect)((function(){"ACTIVE"!==w||H||"cardio"!=r?N.pause():(Number.isFinite(N.value)||N.set(0),N.play())}),[w,N,H,r]),Object(i.useEffect)((function(){"RESTING"!==w||ue?I.pause():I.play()}),[w,I,ue]),Object(i.useEffect)((function(){"ACTIVE"===w&&"cardio"===r&&(0!==I.value||P||(de(be("times_up")),W(!0)),0!==N.value||R||(de(be("duration_up")),A(!0)))}),[I,N,w,r]);var pe={type:"number",pattern:"\\d+",min:"0",inputMode:"numeric"},me="COMPLETE"===w?"success":"neutral",xe=function(e,t){return w===t?e.value<0?"danger":"highlight":me};return Object(_.jsxs)(C,{onClick:j,"data-id":t,className:"set-display flex space-x-2",isActive:E&&!m,children:[Number.isFinite(N.value)&&"cardio"===r&&Object(_.jsx)("div",{className:"time flex-1",children:Object(_.jsx)(Z,{inputProps:pe,isEdit:H&&!m,onToggleEdit:Q,onChange:N.set,value:Math.abs(N.value),formatFunction:h,type:xe(N,"ACTIVE"),labelText:be("time"),defaultValue:"0"})}),Object(_.jsx)("div",{className:"reps flex-1",children:Object(_.jsx)(Z,{inputProps:pe,isEdit:te&&!m,onToggleEdit:re,onChange:U,value:q,type:me,labelText:be("reps"),defaultValue:"8"})}),Object(_.jsx)("div",{className:"weight flex-1",children:Object(_.jsx)(Z,{inputProps:pe,isEdit:ae&&!m,onToggleEdit:se,onChange:G,value:X,type:me,labelText:be("weight"),defaultValue:"10"})}),Object(_.jsx)("div",{className:"rest flex-1",children:Object(_.jsx)(Z,{inputProps:pe,isEdit:ue&&!m,onToggleEdit:le,onChange:I.set,value:Math.abs(I.value),type:xe(I,"RESTING"),formatFunction:h,labelText:be("rest"),defaultValue:o})})]})}function ee(e){var t=e.defaultRPE,r=void 0===t?5:t,n=e.isReadOnly,a=x().t,s=Object(i.useState)(r),c=Object(l.a)(s,2),o=c[0],u=c[1],d=Object(i.useState)(!1),f=Object(l.a)(d,2),b=f[0],p=f[1],m=[a("rpe_title_1"),a("rpe_title_2"),a("rpe_title_3"),a("rpe_title_4"),a("rpe_title_5"),a("rpe_title_6"),a("rpe_title_7"),a("rpe_title_8"),a("rpe_title_9"),a("rpe_title_10")],j=[a("rpe_desc_1"),a("rpe_desc_2"),a("rpe_desc_3"),a("rpe_desc_4"),a("rpe_desc_5"),a("rpe_desc_6"),a("rpe_desc_7"),a("rpe_desc_8"),a("rpe_desc_9"),a("rpe_desc_10")];return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("hr",{className:"border-t border-indigo-200"}),Object(_.jsxs)(C,{children:[Object(_.jsxs)("span",{className:"uppercase text-sm tracking-wider text-indigo-700",children:[a("rpe"),Object(_.jsx)("button",{onClick:function(){return p(!b)},children:Object(_.jsx)(v.g,{className:"inline ml-1 mb-1"})})]}),Object(_.jsx)("input",{className:"rpe val-".concat(o),type:"range",min:"1",value:o,onChange:function(e){return n||u(e.target.value)},max:"10",step:"1"}),Object(_.jsx)("ul",{className:"tracks flex w-full justify-between text-xs -mt-1 text-indigo-700",children:Array.from(Array(10).keys()).map((function(e){return Object(_.jsx)("li",{children:e+1},e)}))}),b&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("hr",{className:"mt-2 border-t border-indigo-200"}),Object(_.jsx)("h4",{className:"text-xs font-semibold mb-1 mt-2 text-indigo-700",children:m[o-1]}),Object(_.jsx)("p",{className:"text-xs text-indigo-700",children:j[o-1]})]})]})]})}r(53);function te(e){var t=e.id,r=e.name,n=e.sets,a=e.isFirst,s=void 0!==a&&a,c=e.isLast,o=void 0!==c&&c,u=e.isActive,d=void 0!==u&&u,f=e.isComplete,b=void 0!==f&&f,p=e.isReadOnly,m=void 0!==p&&p,j=e.defaultRPE,h=void 0===j?5:j,g=e.defaultType,O=void 0===g?"weight":g,y=e.isWorkoutComplete,E=void 0!==y&&y,k=e.activeSetId,w=void 0===k?null:k,N=e.dispatch,I=void 0===N?function(){}:N,C=x().t,P=Object(i.useState)(O),W=Object(l.a)(P,2),M=W[0],V=W[1],q=function(e){I({type:"UPDATE_ACTIVE_SET",payload:{exerciseId:t,setId:e}})},U=function(e){I({type:"MOVE_EXERCISE",payload:{exerciseId:t,factor:e}})},F={cardio:Object(_.jsx)(v.k,{className:"inline text-xl mb-1"}),weight:Object(_.jsx)(v.f,{className:"inline text-xl mb-1"})};return Object(_.jsxs)("div",{className:"exercise relative","data-id":t,"data-type":M,children:[E||m||Object(_.jsxs)("div",{className:"absolute top-1 right-1 text-indigo-500",children:[Object(_.jsx)("button",{disabled:o,onClick:function(){return U(1)},className:"disabled:opacity-50 p-2",children:Object(_.jsx)(v.c,{})}),Object(_.jsx)("button",{disabled:s,onClick:function(){return U(-1)},className:"disabled:opacity-50 p-2",children:Object(_.jsx)(v.e,{})})]}),Object(_.jsx)(S,{isActive:d,children:Object(_.jsxs)(T,{children:[Object(_.jsxs)(R,{onClick:function(){if(!m&&!b){var e="cardio"===M?"weight":"cardio";I({type:"UPDATE_EXERCISE_TYPE",payload:{exerciseId:t,type:e}}),V(e)}},className:"exercise-name",children:[F[M]," ",r]}),n.length?n.map((function(e){return Object(_.jsx)($,{id:e.id,exerciseType:M,exerciseId:t,defaultDurationTime:e.defaultDurationTime,defaultWeight:e.defaultWeight,defaultRestTime:e.defaultRestTime,defaultReps:e.defaultReps,onClick:function(){return q(e.id)},onActivateSet:q,isActive:e.id===w,isReadOnly:m,stage:e.stage,dispatch:I},e.id)})):Object(_.jsx)(A,{children:C("no_sets")}),b&&n.length>0&&Object(_.jsx)(ee,{defaultRPE:h,isReadOnly:m})]})}),E||m||Object(_.jsxs)(L,{children:[Object(_.jsx)(D,{onClick:function(){I({type:"REMOVE_EXERCISE",payload:{exerciseId:t}})},style:{marginRight:"auto"},children:C("remove_exercise")}),d&&null!==w&&Object(_.jsx)(D,{onClick:function(){I({type:"REMOVE_SET",payload:{exerciseId:t}})},children:C("remove_set")}),Object(_.jsx)(D,{onClick:function(){I({type:"ADD_SET",payload:{exerciseId:t}})},children:C("add_set")})]})]})}var re=r(40),ne=r(27);function ie(){return crypto.getRandomValues(new Uint32Array(1))[0].toString(16)}function ae(e,t){var r=Object(ne.cloneDeep)(e);switch(t.type){case"SET_WORKOUT":return t.payload;case"ADD_SET":return function(e,t){var r=t.exerciseId,n=e.exercises.find((function(e){return e.id===r})),i=ie();return n.sets=[].concat(Object(re.a)(n.sets),[{id:i,stage:"IDLE"}]),e.activeSetId=i,e}(r,t.payload);case"REMOVE_SET":return function(e,t){var r=t.exerciseId,n=e.exercises.find((function(e){return e.id===r})),i=n.sets.findIndex((function(t){return t.id===e.activeSetId}));return-1!==i&&(n.sets.splice(i,1),e.activeSetId=null),e}(r,t.payload);case"UPDATE_ACTIVE_SET":return function(e,t){var r=t.setId,n=t.exerciseId;return e.activeSetId=r,e.activeExerciseId=n,e}(r,t.payload);case"UPDATE_SET_STAGE":return function(e,t){var r=e.exercises.find((function(t){return t.id===e.activeExerciseId})),n=r.sets.findIndex((function(t){return t.id===e.activeSetId}));if(-1===n)return e;var i=r.sets[n].stage,a=t||function(e){var t=["IDLE","ACTIVE","RESTING","COMPLETE"],r=t.findIndex((function(t){return t===e}));return t[(r+1)%t.length]}(i);if("COMPLETE"===a&&!t){var s=(n+1)%r.sets.length;e.activeSetId=s>0?r.sets[(n+1)%r.sets.length].id:null}return r.sets[n].stage=a,j(r)||(e.activeSetId=null),e}(r);case"UPDATE_EXERCISE_TYPE":return function(e,t){var r=t.exerciseId,n=t.type,i=e.exercises.findIndex((function(e){return e.id===r}));return-1===i||(e.exercises[i].type=n),e}(r,t.payload);case"COMPLETE_EXERCISE":return function(e){var t,r=(e.exercises.findIndex((function(t){return t.id===e.activeExerciseId}))+1)%e.exercises.length,n=e.exercises[r];return e.activeExerciseId=n.id,e.activeSetId=(null===(t=n.sets[0])||void 0===t?void 0:t.id)||null,e}(r);case"ADD_EXERCISE":return function(e,t){var r=t.name;return e.exercises.push({id:ie(),name:r,sets:[]}),e}(r,t.payload);case"COMPLETE_WORKOUT":return function(e){return e.isComplete=!0,e}(r);case"MOVE_EXERCISE":return function(e,t){var r=t.exerciseId,n=t.factor,i=e.exercises.findIndex((function(e){return e.id===r}));if(-1===i)return e;var a=Math.min(Math.max(0,i+n),e.exercises.length-1),s=e.exercises[i],c=e.exercises[a];return e.exercises[i]=c,e.exercises[a]=s,e}(r,t.payload);case"REMOVE_EXERCISE":return function(e,t){var r=t.exerciseId;return e.exercises=e.exercises.filter((function(e){return e.id!==r})),e}(r,t.payload);default:throw new Error}}function se(e){var t=x().t,r=e.id,n=e.createNew,a=void 0===n||n,s=e.fromLogs,c=void 0!==s&&s,u=X(),d=J(),f=d.requestNotificationPermission,b=d.hasAskedPermission,p=Object(i.useReducer)(ae,null),m=Object(l.a)(p,2),h=m[0],g=m[1],O=Y("mainTimer",0);Object(i.useEffect)((function(){null===u||void 0===u||u.loadWorkoutLogById(r,a,c).then((function(e){g({type:"SET_WORKOUT",payload:e}),O.set(e.duration)}))}),[u,r,a,c]);return h?Object(_.jsxs)("div",{children:[Object(_.jsxs)("header",{className:"flex items-center pt-4",children:[Object(_.jsx)(o.b,{className:"text-indigo-500 px-3 pr-0 text-xl",to:"/",children:Object(_.jsx)(v.d,{})}),Object(_.jsx)("h2",{className:"workout-name text-2xl text-indigo-800 font-semibold px-3 pr-2",children:h.name}),b||Object(_.jsx)("button",{onClick:f,className:"p-1 text-base text-indigo-800",children:Object(_.jsx)(v.a,{className:"inline"})}),a&&!O.isRunning&&!h.isComplete&&Object(_.jsx)("button",{onClick:function(){var e=G(h.id);u.saveWorkoutTemplate(h.id,e.exercises)},className:"text-indigo-500 px-3 ml-auto text-xl",to:"/",children:Object(_.jsx)(v.l,{})})]}),Object(_.jsxs)("main",{children:[h.exercises.length>0?Object(_.jsx)("ul",{className:"flex flex-col space-y-4 p-3",children:h.exercises.map((function(e,t){return Object(_.jsx)("li",{children:Object(_.jsx)(te,{id:e.id,isFirst:0===t,isWorkoutComplete:h.isComplete,isLast:t===h.exercises.length-1,isActive:e.id===h.activeExerciseId&&a,isComplete:!j(e),isReadOnly:!a||h.isComplete,name:e.name,sets:e.sets,defaultRPE:e.rpe,defaultType:e.type,activeSetId:h.activeSetId,dispatch:g})},e.id)}))}):Object(_.jsx)("p",{className:"px-3 my-2 text-indigo-500",children:t("no_exercise")}),h.isComplete||!a||Object(_.jsx)(Q,{dispatch:g})]}),Object(_.jsx)(H,{timer:O,isReadOnly:!a,loadedId:r,state:h,dispatch:g})]}):null}var ce={pt:f.a,en:b.a};function oe(){var e=Object(i.useState)([]),t=Object(l.a)(e,2),r=t[0],n=t[1],a=X(),s=x(),c=s.t,u=s.language;Object(i.useEffect)((function(){null===a||void 0===a||a.getAllData("logs").then(n)}),[a]);var f=function(){var e=Object(V.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===a||void 0===a||a.eraseLogEntry(t),n(r.filter((function(e){return e.persistenceKey!==t})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(!r.length)return null;var b=ce[u],p={};b&&(p.locale=b);var m=Object(ne.sortBy)(r,(function(e){return-e.date.valueOf()}));return Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{className:"workout-name text-2xl text-blue-800 font-semibold px-3 pt-4",children:c("history")}),Object(_.jsx)("ul",{className:"flex flex-col space-y-4 p-3",children:m.map((function(e){return Object(_.jsxs)(o.b,{to:{pathname:"/viewWorkout",search:"?id=".concat(e.persistenceKey)},className:"p-2 border border-blue-200 relative flex flex-wrap bg-blue-50 rounded-xl",children:[Object(_.jsx)("button",{onClick:function(t){f(e.persistenceKey),t.preventDefault()},className:"absolute p-2 top-0 right-0 text-blue-400",children:Object(_.jsx)(v.o,{})}),Object(_.jsxs)("h2",{className:"text-blue-700 w-full text-md",children:[Object(_.jsx)(v.f,{className:"-mt-1 inline text-lg"})," ",e.name]}),Object(_.jsx)("p",{className:"text-blue-600 text-sm",children:Object(d.a)(e.date,"PPp",p)})]},e.persistenceKey)}))})]})}function ue(e){var t=x().t,r=Object(i.useState)(""),n=Object(l.a)(r,2),a=n[0],s=n[1],c=e.onAddWorkout,o=void 0===c?function(){}:c;return Object(_.jsx)(I,{onSubmit:function(e){e.preventDefault(),o(a),s("")},onChange:function(e){return s(e.target.value)},placeholder:t("workout_name"),label:t("add_workout"),value:a})}var le=r(57),de={pt:f.a,en:b.a};function fe(e){var t=e.name,r=e.onRemoveWorkout,n=e.id,a=Object(i.useState)(null),s=Object(l.a)(a,2),c=s[0],u=s[1],d=X(),f=x(),b=f.t,p=f.language;Object(i.useEffect)(Object(V.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===d||void 0===d||d.getLastLogEntry(n).then((function(e){e&&u(e.date)}));case 1:case"end":return e.stop()}}),e)}))),[d]);var m=de[p],j={};return m&&(j.locale=m),Object(_.jsxs)(o.b,{to:{pathname:"/newWorkout",search:"?id=".concat(n)},className:"p-2 border border-indigo-200 relative flex flex-wrap bg-indigo-50 rounded-xl",children:[Object(_.jsx)("button",{onClick:function(e){r(n),e.preventDefault()},className:"p-2 absolute top-0 right-0 text-indigo-400",children:Object(_.jsx)(v.o,{})}),Object(_.jsxs)("h2",{className:"text-indigo-700 w-full text-md",children:[Object(_.jsx)(v.f,{className:"-mt-1 inline text-lg"})," ",t]}),c&&Object(_.jsxs)("p",{className:"text-indigo-600 text-sm",children:[b("last_run"),": ",Object(le.a)(c,new Date,j)]})]})}function be(){var e=X(),t=x().t,r=Object(i.useState)([]),n=Object(l.a)(r,2),a=n[0],s=n[1];Object(i.useEffect)((function(){null===e||void 0===e||e.getAllData("workouts").then(s)}),[e]);var c=function(){var t=Object(V.a)(M.a.mark((function t(r){var n;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={id:ie(),name:r,exercises:[]},!e){t.next=4;break}return t.next=4,e.saveWorkout(n);case 4:s(a.concat([n]));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o=function(){var r=Object(V.a)(M.a.mark((function r(n){return M.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!window.confirm(t("confirm_delete"))){r.next=6;break}if(!e){r.next=5;break}return r.next=5,e.eraseWorkout(n);case 5:s(a.filter((function(e){return e.id!==n})));case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{className:"workout-name text-2xl text-indigo-800 font-semibold px-3 pt-4",children:t("workouts_list")}),a.length>0?Object(_.jsx)("ul",{className:"flex flex-col space-y-4 p-3",children:a.map((function(e){return Object(_.jsx)(fe,{id:e.id,name:e.name,onRemoveWorkout:o},e.id)}))}):Object(_.jsx)("p",{className:"px-3 my-2 text-indigo-500",children:t("no_workout")}),Object(_.jsx)(ue,{onAddWorkout:c})]})}var pe=function(){var e=function(e){var t=new URLSearchParams(e.location.search).get("id"),r=new URLSearchParams(e.location.search).get("fromLogs"),n="/newWorkout"===e.match.path;return("/viewWorkout"===e.match.path||r)&&(t=Number(t)),Object(_.jsx)(se,{id:t,createNew:n,fromLogs:Boolean(r)})};return Object(_.jsx)(y,{children:Object(_.jsx)(o.a,{basename:"/WorkoutTracker",children:Object(_.jsxs)(u.c,{children:[Object(_.jsxs)(u.a,{exact:!0,path:"/",children:[Object(_.jsx)(be,{}),Object(_.jsx)(oe,{})]}),Object(_.jsx)(u.a,{path:"/viewWorkout",render:e}),Object(_.jsx)(u.a,{path:"/newWorkout",render:e})]})})})};c.a.render(Object(_.jsx)(a.a.StrictMode,{children:Object(_.jsx)(pe,{})}),document.getElementById("root"))}},[[55,1,2]]]);
//# sourceMappingURL=main.080b5b58.chunk.js.map